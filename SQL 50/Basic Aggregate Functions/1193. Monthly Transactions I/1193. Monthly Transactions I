select 
  a.month, 
  a.country, 
  count(a.trans_date) as trans_count,
  sum(case when state = 'approved' then 1 else 0 end) as approved_count,
  sum(amount) as trans_total_amount,
  sum(case when state = 'approved' then amount else 0 end) as approved_total_amount
from (select *, date_format(trans_date, '%Y-%m') as month from Transactions) as a
group by a.month, a.country
